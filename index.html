<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Golden Gallop: 2026 Greeting Guide</title>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    :root {
      --imperial-red: #BC002D;
      --harvest-gold: #FFD700;
      --ink-black: #1a1a1a;
      --soft-white: #FAFAF8;
      --light-gold: #FFF8E1;
    }
    @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Inter:wght@300;400;500;600;700&display=swap');
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Inter',sans-serif;background:var(--soft-white);color:var(--ink-black);overflow-x:hidden}
    .font-cn{font-family:'Noto Serif SC',serif}

    /* === Animations === */
    @keyframes gallopIn{0%{opacity:0;transform:translateX(-60px) rotate(-3deg)}60%{opacity:1;transform:translateX(10px) rotate(1deg)}100%{opacity:1;transform:translateX(0) rotate(0)}}
    @keyframes gallopUp{0%{opacity:0;transform:translateY(40px)}100%{opacity:1;transform:translateY(0)}}
    @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
    @keyframes shake{0%,100%{transform:translateX(0)}20%{transform:translateX(-8px)}40%{transform:translateX(8px)}60%{transform:translateX(-5px)}80%{transform:translateX(5px)}}
    @keyframes hongbaoFill{0%{transform:scale(1)}40%{transform:scale(1.3) rotate(-5deg)}70%{transform:scale(1.1) rotate(3deg)}100%{transform:scale(1) rotate(0)}}
    @keyframes slideUp{0%{opacity:0;transform:translateY(30px)}100%{opacity:1;transform:translateY(0)}}
    @keyframes popIn{0%{opacity:0;transform:scale(0.7)}70%{transform:scale(1.05)}100%{opacity:1;transform:scale(1)}}
    @keyframes confettiDrift{0%{opacity:1;transform:translateY(0) rotate(0deg)}100%{opacity:0;transform:translateY(-200px) rotate(720deg) scale(0.3)}}
    @keyframes gentlePulse{0%,100%{box-shadow:0 0 0 0 rgba(188,0,45,0)}50%{box-shadow:0 0 0 8px rgba(188,0,45,0.08)}}

    .gallop-in{animation:gallopIn .7s cubic-bezier(.22,1,.36,1) both}
    .gallop-up{animation:gallopUp .6s cubic-bezier(.22,1,.36,1) both}
    .float{animation:float 3s ease-in-out infinite}
    .shake{animation:shake .5s ease-in-out}
    .hongbao-fill{animation:hongbaoFill .6s cubic-bezier(.22,1,.36,1)}
    .slide-up{animation:slideUp .5s cubic-bezier(.22,1,.36,1) both}
    .pop-in{animation:popIn .4s cubic-bezier(.22,1,.36,1) both}
    .gentle-pulse{animation:gentlePulse 2s ease-in-out infinite}

    .geo-border{background:repeating-linear-gradient(90deg,var(--imperial-red) 0px,var(--imperial-red) 20px,var(--harvest-gold) 20px,var(--harvest-gold) 24px,transparent 24px,transparent 30px);height:4px}
    .horse-bg{opacity:.04;position:absolute;right:-5%;top:50%;transform:translateY(-50%);width:50%;max-width:500px}

    /* Hongbao tracker */
    .hb-icon{font-size:1.6rem;transition:all .3s ease;filter:grayscale(1) opacity(.3)}
    .hb-icon.filled{filter:none;animation:hongbaoFill .6s cubic-bezier(.22,1,.36,1)}

    /* Character spotlight */
    .character-spotlight{transition:all .4s cubic-bezier(.22,1,.36,1)}

    /* Answer option */
    .answer-option{transition:all .3s cubic-bezier(.22,1,.36,1);cursor:pointer;user-select:none;-webkit-user-select:none}
    .answer-option:hover:not(.opt-correct):not(.opt-wrong):not(.opt-disabled){transform:translateY(-3px);box-shadow:0 8px 24px rgba(188,0,45,.1);border-color:var(--imperial-red)}
    .answer-option.opt-correct{border-color:#16a34a!important;background:rgba(22,163,74,.05)!important}
    .answer-option.opt-wrong{border-color:var(--imperial-red)!important;background:rgba(188,0,45,.04)!important;animation:shake .5s ease-in-out}
    .answer-option.opt-disabled{opacity:.4;pointer-events:none}

    /* Meaning reveal */
    .meaning-reveal{max-height:0;opacity:0;overflow:hidden;transition:max-height .4s cubic-bezier(.22,1,.36,1),opacity .3s ease .05s}
    .meaning-reveal.meaning-show{max-height:60px;opacity:1}
    @media(hover:hover){.answer-option:hover .meaning-reveal{max-height:60px;opacity:1}.answer-option:hover .meaning-hint{opacity:0;max-height:0}}
    .meaning-hint{font-size:.65rem;color:#bbb;transition:opacity .2s ease;cursor:pointer}

    /* Confetti */
    .confetti{position:fixed;pointer-events:none;z-index:100;animation:confettiDrift 1.8s cubic-bezier(.22,1,.36,1) forwards}

    /* Stats badge */
    .stat-badge{background:linear-gradient(135deg,#fff 0%,var(--light-gold) 100%)}

    ::-webkit-scrollbar{width:6px}
    ::-webkit-scrollbar-track{background:var(--soft-white)}
    ::-webkit-scrollbar-thumb{background:#ddd;border-radius:3px}
  </style>
</head>

<body x-data="greetingGame()" x-init="init()">
  <div class="geo-border w-full"></div>

  <!-- Toast -->
  <div x-show="showToast" x-transition class="fixed bottom-6 left-1/2 transform -translate-x-1/2 z-50 bg-gray-900 text-white px-6 py-3 rounded-full shadow-lg text-sm font-medium" style="display:none">
    <span x-text="toastMessage"></span>
  </div>

  <!-- ==================== HERO ==================== -->
  <header class="relative overflow-hidden px-4 sm:px-6 pt-16 sm:pt-20 pb-10" style="background:linear-gradient(135deg,var(--soft-white) 0%,var(--light-gold) 100%);min-height:100vh;min-height:100dvh">
    <svg class="horse-bg" viewBox="0 0 400 400" fill="none"><path d="M320 280c-10-40-30-60-50-80-5-5-8-15-5-25 5-15 15-30 10-50-5-15-20-25-35-20-5-20-20-35-40-35-15 0-25 8-30 20-10-5-25-5-35 5-15 15-10 35-5 50l-20 30c-15 20-25 45-20 70 5 30 25 55 55 65l10 3c15 5 30 7 45 7h30c20 0 40-5 55-15 20-13 35-35 40-60 3-15-1-30-5-45z" fill="var(--imperial-red)"/><ellipse cx="215" cy="155" rx="4" ry="5" fill="var(--harvest-gold)"/></svg>

    <!-- === Scattered characters (desktop: absolute, mobile: grid) === -->
    <!-- On md+ screens these scatter around the hero via absolute positioning -->
    <!-- On mobile they form a compact grid below the mission card -->

    <!-- Grandma ‚Äî top left -->
    <div class="hero-char hidden md:block absolute" style="left:3%;top:12%;">
      <svg width="70" height="88" viewBox="0 0 56 72" fill="none"><circle cx="28" cy="16" r="11" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="23" cy="14" r="1.5" fill="var(--ink-black)"/><circle cx="33" cy="14" r="1.5" fill="var(--ink-black)"/><path d="M24 19c2 2 6 2 8 0" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><circle cx="23" cy="14" r="4" stroke="var(--harvest-gold)" stroke-width="1" fill="none"/><circle cx="33" cy="14" r="4" stroke="var(--harvest-gold)" stroke-width="1" fill="none"/><line x1="27" y1="14" x2="29" y2="14" stroke="var(--harvest-gold)" stroke-width="1"/><ellipse cx="28" cy="6" rx="6" ry="4" fill="var(--imperial-red)" opacity=".15"/><line x1="28" y1="27" x2="28" y2="50" stroke="var(--imperial-red)" stroke-width="2.5" stroke-linecap="round"/><line x1="28" y1="35" x2="18" y2="44" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="35" x2="38" y2="44" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="20" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="36" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="38" y1="44" x2="42" y2="64" stroke="var(--harvest-gold)" stroke-width="1.5" stroke-linecap="round"/></svg>
      <p class="text-xs font-semibold text-center" style="color:var(--ink-black)">Grandma</p>
      <p class="text-xs text-gray-400 italic text-center leading-tight">will ask about<br>marriage</p>
    </div>

    <!-- Boss ‚Äî top right -->
    <div class="hero-char hidden md:block absolute" style="right:4%;top:8%;">
      <svg width="70" height="88" viewBox="0 0 56 72" fill="none"><circle cx="28" cy="16" r="11" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="24" cy="14" r="1.5" fill="var(--ink-black)"/><circle cx="32" cy="14" r="1.5" fill="var(--ink-black)"/><path d="M25 19c1.5 1.5 4.5 1.5 6 0" stroke="var(--ink-black)" stroke-width="1.2" stroke-linecap="round"/><path d="M17 12c0-8 8-13 15-11 5 1.5 7 5 7 8" stroke="var(--ink-black)" stroke-width="2" fill="none" stroke-linecap="round"/><line x1="28" y1="27" x2="28" y2="50" stroke="var(--ink-black)" stroke-width="2.5" stroke-linecap="round"/><polygon points="28,28 25,38 28,36 31,38" fill="var(--imperial-red)"/><line x1="28" y1="35" x2="18" y2="43" stroke="var(--ink-black)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="35" x2="38" y2="43" stroke="var(--ink-black)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="21" y2="65" stroke="var(--ink-black)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="35" y2="65" stroke="var(--ink-black)" stroke-width="2" stroke-linecap="round"/></svg>
      <p class="text-xs font-semibold text-center" style="color:var(--ink-black)">Boss Chen</p>
      <p class="text-xs text-gray-400 italic text-center leading-tight">mom's mahjong<br>friend</p>
    </div>

    <!-- David ‚Äî left middle -->
    <div class="hero-char hidden md:block absolute" style="left:6%;top:48%;">
      <svg width="70" height="88" viewBox="0 0 56 72" fill="none"><circle cx="28" cy="16" r="11" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="24" cy="14" r="1.5" fill="var(--ink-black)"/><circle cx="32" cy="14" r="1.5" fill="var(--ink-black)"/><path d="M24 19c2 2 6 2 8 0" stroke="var(--ink-black)" stroke-width="1.2" stroke-linecap="round"/><ellipse cx="28" cy="7" rx="8" ry="3.5" fill="var(--harvest-gold)" opacity=".7"/><polygon points="28,3 26,7 30,7" fill="none" stroke="#fff" stroke-width=".7"/><polygon points="28,8 26,4 30,4" fill="none" stroke="#fff" stroke-width=".7"/><path d="M18 14c-1-4 1-9 4-11" stroke="var(--ink-black)" stroke-width="1.5" fill="none" stroke-linecap="round"/><path d="M38 14c1-4-1-9-4-11" stroke="var(--ink-black)" stroke-width="1.5" fill="none" stroke-linecap="round"/><line x1="28" y1="27" x2="28" y2="50" stroke="var(--imperial-red)" stroke-width="2.5" stroke-linecap="round"/><line x1="28" y1="35" x2="18" y2="44" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="35" x2="38" y2="44" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><rect x="14" y="38" width="4" height="10" rx="1.5" fill="var(--harvest-gold)" opacity=".5"/><rect x="15" y="35" width="2" height="4" rx="1" fill="var(--harvest-gold)" opacity=".5"/><line x1="28" y1="50" x2="21" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="35" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/></svg>
      <p class="text-xs font-semibold text-center" style="color:var(--ink-black)">David</p>
      <p class="text-xs text-gray-400 italic text-center leading-tight">here for the<br>dumplings</p>
    </div>

    <!-- Jenny ‚Äî right middle -->
    <div class="hero-char hidden md:block absolute" style="right:5%;top:44%;">
      <svg width="70" height="88" viewBox="0 0 56 72" fill="none"><circle cx="28" cy="16" r="11" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="24" cy="14" r="1.5" fill="var(--ink-black)"/><circle cx="32" cy="14" r="1.5" fill="var(--ink-black)"/><path d="M24 19c2 2 6 2 8 0" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><path d="M17 14c0-9 6-14 11-14s11 5 11 14" stroke="var(--ink-black)" stroke-width="2.5" fill="none"/><line x1="17" y1="14" x2="15" y2="30" stroke="var(--ink-black)" stroke-width="2" stroke-linecap="round"/><line x1="39" y1="14" x2="41" y2="30" stroke="var(--ink-black)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="27" x2="28" y2="50" stroke="var(--imperial-red)" stroke-width="2.5" stroke-linecap="round"/><line x1="28" y1="35" x2="18" y2="44" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="35" x2="38" y2="44" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><rect x="36" y="40" width="5" height="8" rx="1" fill="var(--harvest-gold)" opacity=".5"/><line x1="28" y1="50" x2="21" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="35" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/></svg>
      <p class="text-xs font-semibold text-center" style="color:var(--ink-black)">Jenny</p>
      <p class="text-xs text-gray-400 italic text-center leading-tight">rediscovering<br>her roots</p>
    </div>

    <!-- Mrs. Lau ‚Äî bottom left -->
    <div class="hero-char hidden md:block absolute" style="left:12%;bottom:10%;">
      <svg width="70" height="88" viewBox="0 0 56 72" fill="none"><circle cx="28" cy="16" r="11" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="24" cy="14" r="1.5" fill="var(--ink-black)"/><circle cx="32" cy="14" r="1.5" fill="var(--ink-black)"/><path d="M24 19c2 2 6 2 8 0" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><path d="M19 11c-1-7 5-12 9-12s10 5 9 12" stroke="var(--ink-black)" stroke-width="2" fill="none"/><circle cx="28" cy="4" r="4" fill="var(--ink-black)" opacity=".15"/><line x1="28" y1="27" x2="28" y2="50" stroke="var(--imperial-red)" stroke-width="2.5" stroke-linecap="round"/><path d="M21 32 L35 32 L33 50 L23 50 Z" fill="var(--harvest-gold)" opacity=".2" stroke="var(--harvest-gold)" stroke-width="1"/><line x1="28" y1="28" x2="28" y2="32" stroke="var(--harvest-gold)" stroke-width="1"/><line x1="28" y1="35" x2="18" y2="44" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="35" x2="38" y2="44" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="38" y1="44" x2="44" y2="36" stroke="#16a34a" stroke-width="2" stroke-linecap="round"/><line x1="44" y1="36" x2="46" y2="32" stroke="#16a34a" stroke-width="1.5" stroke-linecap="round"/><line x1="44" y1="36" x2="42" y2="31" stroke="#16a34a" stroke-width="1.5" stroke-linecap="round"/><line x1="28" y1="50" x2="21" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="35" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/></svg>
      <p class="text-xs font-semibold text-center" style="color:var(--ink-black)">Mrs. Lau</p>
      <p class="text-xs text-gray-400 italic text-center leading-tight">knows what<br>you bought</p>
    </div>

    <!-- Mr. Peterson ‚Äî bottom right -->
    <div class="hero-char hidden md:block absolute" style="right:10%;bottom:8%;">
      <svg width="70" height="88" viewBox="0 0 56 72" fill="none"><circle cx="28" cy="16" r="11" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="24" cy="14" r="1.5" fill="var(--ink-black)"/><circle cx="32" cy="14" r="1.5" fill="var(--ink-black)"/><path d="M23 20c2-2 6-2 8 0" stroke="var(--ink-black)" stroke-width="1.5" stroke-linecap="round"/><line x1="21" y1="10" x2="26" y2="11.5" stroke="var(--ink-black)" stroke-width="1.5" stroke-linecap="round"/><line x1="35" y1="10" x2="30" y2="11.5" stroke="var(--ink-black)" stroke-width="1.5" stroke-linecap="round"/><path d="M17 11c1-7 5-11 11-11s10 4 11 11" stroke="var(--ink-black)" stroke-width="2" fill="none"/><line x1="22" y1="2" x2="20" y2="0" stroke="var(--ink-black)" stroke-width="1.5" stroke-linecap="round"/><line x1="30" y1="1" x2="32" y2="-1" stroke="var(--ink-black)" stroke-width="1.5" stroke-linecap="round"/><line x1="26" y1="1" x2="25" y2="-1" stroke="var(--ink-black)" stroke-width="1.5" stroke-linecap="round"/><line x1="28" y1="27" x2="28" y2="50" stroke="#8B7D6B" stroke-width="2.5" stroke-linecap="round"/><path d="M22 28 L28 38 L34 28" stroke="#8B7D6B" stroke-width="1.5" fill="none" stroke-linecap="round"/><line x1="18" y1="36" x2="38" y2="36" stroke="#8B7D6B" stroke-width="2" stroke-linecap="round"/><line x1="18" y1="36" x2="20" y2="40" stroke="#8B7D6B" stroke-width="2" stroke-linecap="round"/><line x1="38" y1="36" x2="36" y2="40" stroke="#8B7D6B" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="21" y2="63" stroke="#8B7D6B" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="35" y2="63" stroke="#8B7D6B" stroke-width="2" stroke-linecap="round"/><ellipse cx="19" cy="65" rx="4" ry="2" fill="#8B7D6B" opacity=".3"/><ellipse cx="37" cy="65" rx="4" ry="2" fill="#8B7D6B" opacity=".3"/><path d="M42 20c2-3 2-6 0-8" stroke="#ccc" stroke-width="1" fill="none" stroke-linecap="round"/><path d="M46 22c2-3 2-6 0-8" stroke="#ccc" stroke-width="1" fill="none" stroke-linecap="round"/></svg>
      <p class="text-xs font-semibold text-center" style="color:var(--ink-black)">Mr. Peterson</p>
      <p class="text-xs text-gray-400 italic text-center leading-tight">smells the fish</p>
    </div>

    <!-- Nephew ‚Äî far left, lower -->
    <div class="hero-char hidden md:block absolute" style="left:2%;top:78%;">
      <svg width="64" height="82" viewBox="0 0 56 72" fill="none"><circle cx="28" cy="18" r="10" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="24" cy="16" r="1.5" fill="var(--ink-black)"/><circle cx="32" cy="16" r="1.5" fill="var(--ink-black)"/><path d="M25 21c1 1.5 5 1.5 6 0" stroke="var(--ink-black)" stroke-width="1.2" stroke-linecap="round"/><polygon points="16,11 28,6 40,11 28,14" fill="var(--ink-black)"/><line x1="28" y1="10" x2="28" y2="6" stroke="var(--ink-black)" stroke-width="1.5"/><line x1="40" y1="11" x2="40" y2="16" stroke="var(--ink-black)" stroke-width="1"/><circle cx="40" cy="17" r="1.5" fill="var(--harvest-gold)"/><line x1="28" y1="28" x2="28" y2="48" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="34" x2="19" y2="42" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="34" x2="37" y2="42" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><rect x="34" y="38" width="8" height="6" rx="1" fill="var(--harvest-gold)" opacity=".6"/><line x1="28" y1="48" x2="21" y2="62" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="48" x2="35" y2="62" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/></svg>
      <p class="text-xs font-semibold text-center" style="color:var(--ink-black)">Nephew</p>
      <p class="text-xs text-gray-400 italic text-center leading-tight">wants WiFi</p>
    </div>

    <!-- Uncle & Auntie ‚Äî far right, upper-mid -->
    <div class="hero-char hidden md:block absolute" style="right:1%;top:72%;">
      <svg width="86" height="88" viewBox="0 0 68 72" fill="none"><circle cx="22" cy="16" r="9" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="19" cy="14" r="1.2" fill="var(--ink-black)"/><circle cx="25" cy="14" r="1.2" fill="var(--ink-black)"/><path d="M19 18c1.5 1.5 4.5 1.5 6 0" stroke="var(--ink-black)" stroke-width="1" stroke-linecap="round"/><path d="M13 12c0-7 5-11 9-11s9 4 9 11" stroke="var(--ink-black)" stroke-width="2" fill="none"/><line x1="22" y1="25" x2="22" y2="46" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="22" y1="32" x2="14" y2="40" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><line x1="22" y1="32" x2="30" y2="40" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><line x1="22" y1="46" x2="16" y2="62" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><line x1="22" y1="46" x2="28" y2="62" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><circle cx="46" cy="16" r="9" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="43" cy="14" r="1.2" fill="var(--ink-black)"/><circle cx="49" cy="14" r="1.2" fill="var(--ink-black)"/><path d="M43 18c1.5 1.5 4.5 1.5 6 0" stroke="var(--imperial-red)" stroke-width="1" stroke-linecap="round"/><path d="M37 12c-1-7 4-12 9-12s10 5 9 12" stroke="var(--ink-black)" stroke-width="2" fill="none"/><line x1="37" y1="12" x2="36" y2="26" stroke="var(--ink-black)" stroke-width="1.5" stroke-linecap="round"/><line x1="55" y1="12" x2="56" y2="26" stroke="var(--ink-black)" stroke-width="1.5" stroke-linecap="round"/><line x1="46" y1="25" x2="46" y2="46" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="46" y1="32" x2="38" y2="40" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><line x1="46" y1="32" x2="54" y2="40" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><line x1="46" y1="46" x2="40" y2="62" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><line x1="46" y1="46" x2="52" y2="62" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><path d="M32 36c0-2 2-4 3-2s3 0 3 2c0 3-3 5-3 5s-3-2-3-5z" fill="var(--imperial-red)" opacity=".3"/></svg>
      <p class="text-xs font-semibold text-center" style="color:var(--ink-black)">Uncle & Auntie</p>
      <p class="text-xs text-gray-400 italic text-center leading-tight">drove 3 hours</p>
    </div>

    <!-- Cousin ‚Äî top, slightly left of center -->
    <div class="hero-char hidden md:block absolute" style="left:22%;top:5%;">
      <svg width="64" height="82" viewBox="0 0 56 72" fill="none"><circle cx="28" cy="16" r="11" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="24" cy="14" r="1.5" fill="var(--ink-black)"/><circle cx="32" cy="14" r="1.5" fill="var(--ink-black)"/><path d="M24 19c2 2 6 2 8 0" stroke="var(--ink-black)" stroke-width="1.2" stroke-linecap="round"/><path d="M17 13c0-8 5-13 11-13s11 5 11 13" stroke="var(--ink-black)" stroke-width="2.5" fill="none"/><line x1="28" y1="27" x2="28" y2="50" stroke="var(--imperial-red)" stroke-width="2.5" stroke-linecap="round"/><line x1="28" y1="35" x2="17" y2="42" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="35" x2="40" y2="28" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><circle cx="42" cy="26" r="3" fill="var(--harvest-gold)" opacity=".3"/><line x1="28" y1="50" x2="21" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="35" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/></svg>
      <p class="text-xs font-semibold text-center" style="color:var(--ink-black)">Cousin Wei</p>
      <p class="text-xs text-gray-400 italic text-center leading-tight">back from Bali</p>
    </div>

    <!-- === Center content === -->
    <div class="relative z-10 text-center max-w-xl mx-auto flex flex-col items-center justify-center" style="min-height:calc(100vh - 8rem);min-height:calc(100dvh - 8rem)">
      <div class="gallop-in inline-flex items-center gap-2 px-5 py-2 rounded-full border-2 mb-6" style="border-color:var(--imperial-red);color:var(--imperial-red)">
        <span class="text-lg">üê¥</span>
        <span class="text-xs sm:text-sm font-semibold tracking-widest uppercase">Year of the Horse ¬∑ 2026</span>
      </div>
      <h1 class="gallop-in font-cn text-4xl sm:text-5xl md:text-7xl font-bold mb-3" style="animation-delay:.1s;color:var(--ink-black)">È©¨Âà∞ÊàêÂäü</h1>
      <p class="gallop-in text-base sm:text-lg md:text-xl mb-2 font-light tracking-wide" style="animation-delay:.2s;color:var(--imperial-red)">M«é d√†o ch√©ng g≈çng</p>
      <p class="gallop-in text-sm sm:text-base text-gray-500 mb-8 max-w-md mx-auto px-2" style="animation-delay:.3s">"Success upon the horse's arrival" ‚Äî May achievement gallop swiftly to you in 2026.</p>

      <!-- Mission card -->
      <div class="gallop-up bg-white rounded-2xl shadow-lg px-6 sm:px-8 py-6 max-w-md w-full" style="animation-delay:.5s">
        <p class="text-xs font-semibold tracking-widest uppercase mb-3" style="color:var(--harvest-gold)">Your Mission</p>
        <p class="text-sm text-gray-600 leading-relaxed">The annual interrogation ‚Äî <em>er</em>, reunion ‚Äî begins. You've just walked through the door and the guests are eyeing you expectantly. <strong>What do you say!?</strong></p>
      </div>

      <!-- Mobile-only character grid (SVGs) -->
      <div class="md:hidden mt-6 w-full">
        <p class="text-xs font-semibold tracking-widest uppercase mb-4" style="color:var(--harvest-gold)">Meet the Guests</p>
        <div class="grid grid-cols-3 gap-4 max-w-sm mx-auto">
          <!-- Grandma -->
          <div class="text-center">
            <svg class="mx-auto" width="48" height="60" viewBox="0 0 56 72" fill="none"><circle cx="28" cy="16" r="11" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="23" cy="14" r="1.5" fill="var(--ink-black)"/><circle cx="33" cy="14" r="1.5" fill="var(--ink-black)"/><path d="M24 19c2 2 6 2 8 0" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><circle cx="23" cy="14" r="4" stroke="var(--harvest-gold)" stroke-width="1" fill="none"/><circle cx="33" cy="14" r="4" stroke="var(--harvest-gold)" stroke-width="1" fill="none"/><line x1="27" y1="14" x2="29" y2="14" stroke="var(--harvest-gold)" stroke-width="1"/><line x1="28" y1="27" x2="28" y2="50" stroke="var(--imperial-red)" stroke-width="2.5" stroke-linecap="round"/><line x1="28" y1="35" x2="18" y2="44" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="35" x2="38" y2="44" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="20" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="36" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="38" y1="44" x2="42" y2="64" stroke="var(--harvest-gold)" stroke-width="1.5" stroke-linecap="round"/></svg>
            <p class="text-xs font-semibold mt-1">Grandma</p><p class="text-xs text-gray-400 italic leading-tight">marriage?</p>
          </div>
          <!-- Boss Chen -->
          <div class="text-center">
            <svg class="mx-auto" width="48" height="60" viewBox="0 0 56 72" fill="none"><circle cx="28" cy="16" r="11" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="24" cy="14" r="1.5" fill="var(--ink-black)"/><circle cx="32" cy="14" r="1.5" fill="var(--ink-black)"/><path d="M25 19c1.5 1.5 4.5 1.5 6 0" stroke="var(--ink-black)" stroke-width="1.2" stroke-linecap="round"/><path d="M17 12c0-8 8-13 15-11 5 1.5 7 5 7 8" stroke="var(--ink-black)" stroke-width="2" fill="none" stroke-linecap="round"/><line x1="28" y1="27" x2="28" y2="50" stroke="var(--ink-black)" stroke-width="2.5" stroke-linecap="round"/><polygon points="28,28 25,38 28,36 31,38" fill="var(--imperial-red)"/><line x1="28" y1="35" x2="18" y2="43" stroke="var(--ink-black)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="35" x2="38" y2="43" stroke="var(--ink-black)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="21" y2="65" stroke="var(--ink-black)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="35" y2="65" stroke="var(--ink-black)" stroke-width="2" stroke-linecap="round"/></svg>
            <p class="text-xs font-semibold mt-1">Boss Chen</p><p class="text-xs text-gray-400 italic leading-tight">mom's friend</p>
          </div>
          <!-- Nephew -->
          <div class="text-center">
            <svg class="mx-auto" width="48" height="60" viewBox="0 0 56 72" fill="none"><circle cx="28" cy="18" r="10" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="24" cy="16" r="1.5" fill="var(--ink-black)"/><circle cx="32" cy="16" r="1.5" fill="var(--ink-black)"/><path d="M25 21c1 1.5 5 1.5 6 0" stroke="var(--ink-black)" stroke-width="1.2" stroke-linecap="round"/><polygon points="16,11 28,6 40,11 28,14" fill="var(--ink-black)"/><line x1="28" y1="10" x2="28" y2="6" stroke="var(--ink-black)" stroke-width="1.5"/><line x1="28" y1="28" x2="28" y2="48" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="34" x2="19" y2="42" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="34" x2="37" y2="42" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="48" x2="21" y2="62" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="48" x2="35" y2="62" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/></svg>
            <p class="text-xs font-semibold mt-1">Nephew</p><p class="text-xs text-gray-400 italic leading-tight">wants WiFi</p>
          </div>
          <!-- David -->
          <div class="text-center">
            <svg class="mx-auto" width="48" height="60" viewBox="0 0 56 72" fill="none"><circle cx="28" cy="16" r="11" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="24" cy="14" r="1.5" fill="var(--ink-black)"/><circle cx="32" cy="14" r="1.5" fill="var(--ink-black)"/><path d="M24 19c2 2 6 2 8 0" stroke="var(--ink-black)" stroke-width="1.2" stroke-linecap="round"/><ellipse cx="28" cy="7" rx="8" ry="3.5" fill="var(--harvest-gold)" opacity=".7"/><polygon points="28,3 26,7 30,7" fill="none" stroke="#fff" stroke-width=".7"/><polygon points="28,8 26,4 30,4" fill="none" stroke="#fff" stroke-width=".7"/><line x1="28" y1="27" x2="28" y2="50" stroke="var(--imperial-red)" stroke-width="2.5" stroke-linecap="round"/><line x1="28" y1="35" x2="18" y2="44" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="35" x2="38" y2="44" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="21" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="35" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/></svg>
            <p class="text-xs font-semibold mt-1">David</p><p class="text-xs text-gray-400 italic leading-tight">the dumplings</p>
          </div>
          <!-- Jenny -->
          <div class="text-center">
            <svg class="mx-auto" width="48" height="60" viewBox="0 0 56 72" fill="none"><circle cx="28" cy="16" r="11" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="24" cy="14" r="1.5" fill="var(--ink-black)"/><circle cx="32" cy="14" r="1.5" fill="var(--ink-black)"/><path d="M24 19c2 2 6 2 8 0" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><path d="M17 14c0-9 6-14 11-14s11 5 11 14" stroke="var(--ink-black)" stroke-width="2.5" fill="none"/><line x1="17" y1="14" x2="15" y2="30" stroke="var(--ink-black)" stroke-width="2" stroke-linecap="round"/><line x1="39" y1="14" x2="41" y2="30" stroke="var(--ink-black)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="27" x2="28" y2="50" stroke="var(--imperial-red)" stroke-width="2.5" stroke-linecap="round"/><line x1="28" y1="35" x2="18" y2="44" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="35" x2="38" y2="44" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="21" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="35" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/></svg>
            <p class="text-xs font-semibold mt-1">Jenny</p><p class="text-xs text-gray-400 italic leading-tight">finding roots</p>
          </div>
          <!-- Mrs. Lau -->
          <div class="text-center">
            <svg class="mx-auto" width="48" height="60" viewBox="0 0 56 72" fill="none"><circle cx="28" cy="16" r="11" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="24" cy="14" r="1.5" fill="var(--ink-black)"/><circle cx="32" cy="14" r="1.5" fill="var(--ink-black)"/><path d="M24 19c2 2 6 2 8 0" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><path d="M19 11c-1-7 5-12 9-12s10 5 9 12" stroke="var(--ink-black)" stroke-width="2" fill="none"/><line x1="28" y1="27" x2="28" y2="50" stroke="var(--imperial-red)" stroke-width="2.5" stroke-linecap="round"/><path d="M21 32 L35 32 L33 50 L23 50 Z" fill="var(--harvest-gold)" opacity=".2" stroke="var(--harvest-gold)" stroke-width="1"/><line x1="28" y1="35" x2="18" y2="44" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="35" x2="38" y2="44" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="38" y1="44" x2="44" y2="36" stroke="#16a34a" stroke-width="2" stroke-linecap="round"/><line x1="44" y1="36" x2="46" y2="32" stroke="#16a34a" stroke-width="1.5" stroke-linecap="round"/><line x1="28" y1="50" x2="21" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="35" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/></svg>
            <p class="text-xs font-semibold mt-1">Mrs. Lau</p><p class="text-xs text-gray-400 italic leading-tight">knows all</p>
          </div>
          <!-- Mr. Peterson -->
          <div class="text-center">
            <svg class="mx-auto" width="48" height="60" viewBox="0 0 56 72" fill="none"><circle cx="28" cy="16" r="11" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="24" cy="14" r="1.5" fill="var(--ink-black)"/><circle cx="32" cy="14" r="1.5" fill="var(--ink-black)"/><path d="M23 20c2-2 6-2 8 0" stroke="var(--ink-black)" stroke-width="1.5" stroke-linecap="round"/><line x1="21" y1="10" x2="26" y2="11.5" stroke="var(--ink-black)" stroke-width="1.5" stroke-linecap="round"/><line x1="35" y1="10" x2="30" y2="11.5" stroke="var(--ink-black)" stroke-width="1.5" stroke-linecap="round"/><line x1="28" y1="27" x2="28" y2="50" stroke="#8B7D6B" stroke-width="2.5" stroke-linecap="round"/><path d="M22 28 L28 38 L34 28" stroke="#8B7D6B" stroke-width="1.5" fill="none" stroke-linecap="round"/><line x1="18" y1="36" x2="38" y2="36" stroke="#8B7D6B" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="21" y2="63" stroke="#8B7D6B" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="35" y2="63" stroke="#8B7D6B" stroke-width="2" stroke-linecap="round"/></svg>
            <p class="text-xs font-semibold mt-1">Peterson</p><p class="text-xs text-gray-400 italic leading-tight">smells fish</p>
          </div>
          <!-- Cousin Wei -->
          <div class="text-center">
            <svg class="mx-auto" width="48" height="60" viewBox="0 0 56 72" fill="none"><circle cx="28" cy="16" r="11" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="24" cy="14" r="1.5" fill="var(--ink-black)"/><circle cx="32" cy="14" r="1.5" fill="var(--ink-black)"/><path d="M24 19c2 2 6 2 8 0" stroke="var(--ink-black)" stroke-width="1.2" stroke-linecap="round"/><path d="M17 13c0-8 5-13 11-13s11 5 11 13" stroke="var(--ink-black)" stroke-width="2.5" fill="none"/><line x1="28" y1="27" x2="28" y2="50" stroke="var(--imperial-red)" stroke-width="2.5" stroke-linecap="round"/><line x1="28" y1="35" x2="17" y2="42" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="35" x2="40" y2="28" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="21" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="28" y1="50" x2="35" y2="65" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/></svg>
            <p class="text-xs font-semibold mt-1">Cousin Wei</p><p class="text-xs text-gray-400 italic leading-tight">Bali tan</p>
          </div>
          <!-- Uncle & Auntie -->
          <div class="text-center">
            <svg class="mx-auto" width="58" height="60" viewBox="0 0 68 72" fill="none"><circle cx="22" cy="16" r="9" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="19" cy="14" r="1.2" fill="var(--ink-black)"/><circle cx="25" cy="14" r="1.2" fill="var(--ink-black)"/><path d="M19 18c1.5 1.5 4.5 1.5 6 0" stroke="var(--ink-black)" stroke-width="1" stroke-linecap="round"/><line x1="22" y1="25" x2="22" y2="46" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="22" y1="32" x2="14" y2="40" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><line x1="22" y1="32" x2="30" y2="40" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><line x1="22" y1="46" x2="16" y2="62" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><line x1="22" y1="46" x2="28" y2="62" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><circle cx="46" cy="16" r="9" fill="#FFF" stroke="var(--imperial-red)" stroke-width="2"/><circle cx="43" cy="14" r="1.2" fill="var(--ink-black)"/><circle cx="49" cy="14" r="1.2" fill="var(--ink-black)"/><path d="M43 18c1.5 1.5 4.5 1.5 6 0" stroke="var(--imperial-red)" stroke-width="1" stroke-linecap="round"/><line x1="46" y1="25" x2="46" y2="46" stroke="var(--imperial-red)" stroke-width="2" stroke-linecap="round"/><line x1="46" y1="32" x2="38" y2="40" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><line x1="46" y1="32" x2="54" y2="40" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><line x1="46" y1="46" x2="40" y2="62" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><line x1="46" y1="46" x2="52" y2="62" stroke="var(--imperial-red)" stroke-width="1.5" stroke-linecap="round"/><path d="M32 36c0-2 2-4 3-2s3 0 3 2c0 3-3 5-3 5s-3-2-3-5z" fill="var(--imperial-red)" opacity=".3"/></svg>
            <p class="text-xs font-semibold mt-1">Uncle & Auntie</p><p class="text-xs text-gray-400 italic leading-tight">3hr drive</p>
          </div>
        </div>
      </div>

      <div class="mt-8 float">
        <svg class="w-6 h-6 mx-auto text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"/></svg>
      </div>
    </div>
  </header>

  <!-- ==================== PROGRESS BAR ==================== -->
  <nav class="sticky top-0 z-40 bg-white bg-opacity-95 backdrop-filter backdrop-blur-sm border-b border-gray-100 py-3">
    <div class="max-w-3xl mx-auto px-6">
      <div class="flex items-center justify-between mb-2">
        <p class="text-xs font-semibold tracking-widest uppercase" style="color:var(--imperial-red)">Hongbao Collection</p>
        <div class="flex items-center gap-3">
          <p class="text-xs text-gray-400">Streak: <span class="font-bold" style="color:var(--harvest-gold)" x-text="currentStreak"></span></p>
          <p class="text-xs font-bold" style="color:var(--imperial-red)" x-text="roundIndex + ' / 6'"></p>
        </div>
      </div>
      <div class="flex gap-2 justify-center">
        <template x-for="i in 6" :key="i">
          <span class="hb-icon" :class="i <= hongbaoFilled ? 'filled' : ''">üßß</span>
        </template>
      </div>
    </div>
  </nav>

  <!-- ==================== GAME AREA ==================== -->
  <section class="max-w-3xl mx-auto px-4 sm:px-6 py-12" x-show="!gameComplete">

    <!-- Round counter -->
    <div class="text-center mb-2">
      <p class="text-xs font-semibold tracking-widest uppercase" style="color:var(--harvest-gold)">
        Round <span x-text="roundIndex + 1"></span> of 6
      </p>
    </div>

    <!-- The dinner table scene -->
    <div class="text-center mb-8">
      <div class="inline-flex items-center gap-3 px-5 py-2 rounded-full border" style="border-color:var(--harvest-gold);background:linear-gradient(135deg,#FFF8E1,#FFF)">
        <span class="text-sm">ü•¢</span>
        <span class="font-cn text-xs" style="color:var(--harvest-gold)">Âπ¥Â§úÈ•≠ ¬∑ Reunion Dinner</span>
        <span class="text-sm">ü•¢</span>
      </div>
    </div>

    <!-- Current character spotlight -->
    <template x-if="currentRound">
      <div class="character-spotlight bg-white rounded-3xl shadow-lg border-2 border-gray-100 p-8 text-center mb-8 pop-in" :key="roundIndex">
        <span class="text-6xl block mb-3" x-text="currentRound.character.icon"></span>
        <h3 class="text-xl font-bold mb-1" x-text="currentRound.character.name"></h3>
        <p class="text-sm text-gray-400 mb-4" x-text="currentRound.character.role"></p>
        <div class="inline-block bg-gray-50 rounded-xl px-5 py-3 max-w-sm">
          <p class="text-sm text-gray-600 italic leading-relaxed" x-text="currentRound.character.context"></p>
        </div>
      </div>
    </template>

    <!-- Answer options -->
    <template x-if="currentRound">
      <div>
        <p class="text-center text-xs text-gray-400 mb-4">What do you say?</p>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6">
          <template x-for="(opt, i) in currentRound.options" :key="opt.id + '-' + roundIndex">
            <div @click="submitAnswer(opt)"
                 class="answer-option border-2 border-gray-200 rounded-2xl p-5 text-center"
                 :class="{
                   'opt-correct': roundResult && opt.id === currentRound.correctId,
                   'opt-wrong': roundResult === 'wrong' && opt.id === selectedAnswerId && opt.id !== currentRound.correctId,
                   'opt-disabled': roundResult && opt.id !== currentRound.correctId && opt.id !== selectedAnswerId
                 }">
              <p class="font-cn text-2xl font-bold mb-1" style="color:var(--imperial-red)" x-text="opt.hanzi"></p>
              <p class="text-xs font-medium mb-1" style="color:var(--harvest-gold)" x-text="opt.pinyin"></p>
              <p class="meaning-hint text-center mt-1" x-show="!roundResult && !peekedIds.includes(opt.id)" @click.stop="togglePeek(opt.id)">tap to peek meaning</p>
              <div class="meaning-reveal" :class="(roundResult || peekedIds.includes(opt.id)) ? 'meaning-show' : ''">
                <p class="text-xs text-gray-500 leading-relaxed pt-1" x-text="opt.meaning"></p>
              </div>
            </div>
          </template>
        </div>

        <!-- Explanation after answering -->
        <div x-show="roundResult" x-transition class="slide-up bg-white rounded-2xl border p-6 mb-4" :class="roundResult === 'correct' ? 'border-green-200' : 'border-red-100'">
          <div class="flex items-start gap-3">
            <span class="text-2xl flex-shrink-0" x-text="roundResult === 'correct' ? '‚úÖ' : 'üí°'"></span>
            <div>
              <p class="text-sm font-semibold mb-1" x-text="roundResult === 'correct' ? 'Perfect!' : 'The right greeting was:'"></p>
              <p x-show="roundResult === 'wrong'" class="font-cn text-lg font-bold mb-1" style="color:var(--imperial-red)" x-text="currentRound.correctGreeting.hanzi"></p>
              <p x-show="roundResult === 'wrong'" class="text-xs font-medium mb-2" style="color:var(--harvest-gold)" x-text="currentRound.correctGreeting.pinyin"></p>
              <p class="text-sm text-gray-500 leading-relaxed" x-text="currentRound.why"></p>
            </div>
          </div>
          <div class="text-center mt-5">
            <button @click="nextRound()" class="px-6 py-2.5 rounded-full text-sm font-semibold text-white transition-all hover:shadow-lg" style="background:var(--imperial-red)">
              <span x-text="roundIndex < 5 ? 'Next Guest ‚Üí' : 'See Results'"></span>
            </button>
          </div>
        </div>
      </div>
    </template>
  </section>

  <!-- ==================== VICTORY / RESULTS ==================== -->
  <section x-show="gameComplete" x-transition class="max-w-3xl mx-auto px-6 py-16 text-center">
    <div class="bg-white rounded-3xl shadow-xl border-2 p-10 pop-in" style="border-color:var(--harvest-gold)">
      <p class="text-5xl mb-4" x-text="hongbaoFilled === 6 ? 'üéä' : hongbaoFilled >= 4 ? 'üéâ' : 'üßß'"></p>
      <h3 class="font-cn text-3xl font-bold mb-2" style="color:var(--imperial-red)" x-text="hongbaoFilled === 6 ? 'All Hongbao Filled!' : hongbaoFilled >= 4 ? 'Well Done!' : 'Keep Practicing!'"></h3>
      <p class="text-gray-500 text-sm mb-6">
        You correctly greeted <strong x-text="hongbaoFilled"></strong> out of 6 guests.
        <span x-show="hongbaoFilled === 6">You're a Lunar New Year greeting master!</span>
      </p>

      <!-- Score summary -->
      <div class="flex justify-center gap-4 mb-8">
        <div class="stat-badge rounded-xl px-5 py-3 text-center">
          <p class="text-2xl font-bold" style="color:var(--imperial-red)" x-text="hongbaoFilled + '/6'"></p>
          <p class="text-xs text-gray-400">This Round</p>
        </div>
        <div class="stat-badge rounded-xl px-5 py-3 text-center">
          <p class="text-2xl font-bold" style="color:var(--harvest-gold)" x-text="stats.bestStreak"></p>
          <p class="text-xs text-gray-400">Best Streak</p>
        </div>
        <div class="stat-badge rounded-xl px-5 py-3 text-center">
          <p class="text-2xl font-bold" style="color:var(--imperial-red)" x-text="stats.gamesPlayed"></p>
          <p class="text-xs text-gray-400">Games Played</p>
        </div>
      </div>

      <!-- Review all rounds -->
      <div class="bg-gray-50 rounded-xl p-6 mb-6 text-left">
        <p class="text-xs font-semibold tracking-widest uppercase mb-4 text-center" style="color:var(--harvest-gold)">Round Review</p>
        <div class="space-y-4">
          <template x-for="(r, i) in roundHistory" :key="i">
            <div class="flex items-start gap-3 pb-3 border-b border-gray-100 last:border-0">
              <span class="text-2xl flex-shrink-0" x-text="r.icon"></span>
              <div class="min-w-0 flex-1">
                <div class="flex items-center gap-2 mb-1">
                  <p class="text-sm font-semibold" x-text="r.guestName"></p>
                  <span class="text-xs" x-text="r.wasCorrect ? '‚úÖ' : '‚ùå'"></span>
                </div>
                <p class="font-cn text-lg font-bold" style="color:var(--imperial-red)" x-text="r.correctHanzi"></p>
                <p class="text-xs font-medium" style="color:var(--harvest-gold)" x-text="r.correctPinyin"></p>
                <p class="text-xs text-gray-400 mt-1" x-text="r.correctMeaning"></p>
              </div>
              <button @click="copySingle(r)" class="flex-shrink-0 text-xs px-3 py-1.5 rounded-full border transition hover:shadow-sm" style="border-color:var(--imperial-red);color:var(--imperial-red)">Copy</button>
            </div>
          </template>
        </div>
      </div>

      <div class="flex flex-col sm:flex-row gap-3 justify-center">
        <button @click="copyAll()" class="inline-flex items-center justify-center gap-2 text-sm font-semibold px-6 py-3 rounded-full text-white transition-all hover:shadow-lg" style="background:var(--imperial-red)">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
          Copy All Greetings
        </button>
        <button @click="newGame()" class="inline-flex items-center justify-center gap-2 text-sm font-semibold px-6 py-3 rounded-full border-2 transition-all hover:shadow-md" style="border-color:var(--imperial-red);color:var(--imperial-red)">
          üîÑ New Guests, New Greetings
        </button>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="text-center py-10 px-6 border-t border-gray-100">
    <p class="font-cn text-xl mb-2" style="color:var(--imperial-red)">Êñ∞Âπ¥Âø´‰πê</p>
    <p class="text-xs text-gray-400">The Golden Gallop ¬∑ Year of the Horse 2026</p>
    <p class="text-xs text-gray-300 mt-1">A Digital Altar of Good Fortune</p>
  </footer>
  <div class="geo-border w-full"></div>

  <script>
  function greetingGame() {
    /* ============================================================
       GREETING POOL ‚Äî every greeting the game can draw from
       ============================================================ */
    const ALL_GREETINGS = [
      { id:'shenti',   hanzi:'Ë∫´‰ΩìÂÅ•Â∫∑', pinyin:'Shƒìn t«ê ji√†n kƒÅng',   meaning:'Wishing you good health' },
      { id:'madao',    hanzi:'È©¨Âà∞ÊàêÂäü', pinyin:'M«é d√†o ch√©ng g≈çng',    meaning:'Instant success (Year of the Horse!)' },
      { id:'gongxi',   hanzi:'ÊÅ≠ÂñúÂèëË¥¢', pinyin:'G≈çng x«ê fƒÅ c√°i',      meaning:'Wishing you prosperity & fortune' },
      { id:'wanshi',   hanzi:'‰∏á‰∫ãÂ¶ÇÊÑè', pinyin:'W√†n sh√¨ r√∫ y√¨',       meaning:'May all things go as you wish' },
      { id:'caiyuan',  hanzi:'Ë¥¢Ê∫êÂπøËøõ', pinyin:'C√°i yu√°n gu«éng j√¨n',   meaning:'May wealth flow from all directions' },
      { id:'hejia',    hanzi:'ÈòñÂÆ∂Ê¨¢‰πê', pinyin:'H√© jiƒÅ huƒÅn l√®',      meaning:'Joy for the whole family' },
      { id:'longma',   hanzi:'ÈæôÈ©¨Á≤æÁ•û', pinyin:'L√≥ng m«é jƒ´ng sh√©n',   meaning:'Dragon-horse spirit ‚Äî boundless energy' },
      { id:'niannian', hanzi:'Âπ¥Âπ¥Êúâ‰Ωô', pinyin:'Ni√°n ni√°n y«íu y√∫',    meaning:'Surplus & abundance year after year' },
      { id:'xinxiang', hanzi:'ÂøÉÊÉ≥‰∫ãÊàê', pinyin:'Xƒ´n xi«éng sh√¨ ch√©ng', meaning:'May all your wishes come true' },
      { id:'xueye',    hanzi:'Â≠¶‰∏öÊúâÊàê', pinyin:'Xu√©y√® y«íu ch√©ng',     meaning:'Academic success' },
      { id:'bubu',     hanzi:'Ê≠•Ê≠•È´òÂçá', pinyin:'B√π b√π gƒÅo shƒìng',    meaning:'Promotions at every step' },
      { id:'caiyuangun',hanzi:'Ë¥¢Ê∫êÊªöÊªö',pinyin:'C√°i yu√°n g«în g«în',   meaning:'May wealth roll in' },
      { id:'gongzuo',  hanzi:'Â∑•‰ΩúÈ°∫Âà©', pinyin:'G≈çng zu√≤ sh√πn l√¨',    meaning:'May your work go smoothly' },
      { id:'yifan',    hanzi:'‰∏ÄÂ∏ÜÈ£éÈ°∫', pinyin:'Yƒ´ fƒÅn fƒìng sh√πn',    meaning:'Smooth sailing in all things' },
      { id:'daji',     hanzi:'Â§ßÂêâÂ§ßÂà©', pinyin:'D√† j√≠ d√† l√¨',         meaning:'Great luck & big profits' },
      { id:'shengyi',  hanzi:'ÁîüÊÑèÂÖ¥ÈöÜ', pinyin:'Shƒìng y√¨ xƒ´ng l√≥ng', meaning:'May your business prosper' },
      { id:'yima',     hanzi:'‰∏ÄÈ©¨ÂΩìÂÖà', pinyin:'Yƒ´ m«é dƒÅng xiƒÅn',     meaning:'The lead horse charges ahead' },
      { id:'hejiaxf',  hanzi:'ÈòñÂÆ∂Âπ∏Á¶è', pinyin:'H√© jiƒÅ x√¨ng f√∫',     meaning:'Happiness for the whole family' },
      { id:'shiye',    hanzi:'‰∫ã‰∏öÊúâÊàê', pinyin:'Sh√¨ y√® y«íu ch√©ng',    meaning:'Career success & achievement' },
      { id:'shengguan',hanzi:'ÂçáÂÆòÂèëË¥¢', pinyin:'Shƒìng guƒÅn fƒÅ c√°i',   meaning:'Win promotions & get rich' },
      { id:'hongbao',  hanzi:'ÊÅ≠ÂñúÂèëË¥¢ÔºåÁ∫¢ÂåÖÊãøÊù•', pinyin:'G≈çng x«ê fƒÅ c√°i, h√≥ng bƒÅo n√° l√°i', meaning:'Wishing prosperity ‚Äî now hand over the red envelope!' },
      { id:'changming',hanzi:'ÈïøÂëΩÁôæÂ≤Å', pinyin:'Ch√°ng m√¨ng b«éi su√¨',  meaning:'Long life, a hundred years!' },
      { id:'xinnian',  hanzi:'Êñ∞Âπ¥Âø´‰πê', pinyin:'Xƒ´n ni√°n ku√†i l√®',    meaning:'Happy New Year!' },
    ];

    const greetingMap = {};
    ALL_GREETINGS.forEach(g => greetingMap[g.id] = g);

    /* ============================================================
       SCENARIO POOL ‚Äî characters + correct greetings + context
       Each refresh picks 6 random scenarios from this pool.
       ============================================================ */
    const ALL_SCENARIOS = [
      {
        character: { icon:'üëµ', name:'Grandma', role:'Elder ¬∑ Your father\'s mother', context:'She\'s 85 and beaming at the head of the table. She squeezes your hand as you sit down.' },
        correctId: 'shenti',
        why: 'Health is the most treasured wish for elders. Saying Ë∫´‰ΩìÂÅ•Â∫∑ (Shƒìn t«ê ji√†n kƒÅng) to Grandma shows filial respect ‚Äî you\'re telling her that her well-being matters above all else.',
        distractors: ['caiyuan','bubu','madao','gongzuo','shiye'],
      },
      {
        character: { icon:'üë¥', name:'Grandpa', role:'Elder ¬∑ Family patriarch', context:'He\'s pouring tea for everyone and joking about being older than the zodiac cycle itself.' },
        correctId: 'changming',
        why: 'ÈïøÂëΩÁôæÂ≤Å (Ch√°ng m√¨ng b«éi su√¨) is a deeply respectful wish for elders ‚Äî "Long life, a hundred years!" It honors his age and wishes him many more years of joy.',
        distractors: ['caiyuan','bubu','madao','daji','shengyi'],
      },
      {
        character: { icon:'üëî', name:'Boss Chen', role:'Professional ¬∑ Your department head', context:'He arrived in a sharp suit, red tie for the occasion. He gives you a nod across the table.' },
        correctId: 'madao',
        why: 'In a Horse year, È©¨Âà∞ÊàêÂäü (M«é d√†o ch√©ng g≈çng) is the ultimate power phrase. It combines zodiac relevance with a wish for swift, decisive success ‚Äî ambitious but respectful.',
        distractors: ['shenti','hejia','niannian','xueye','longma'],
      },
      {
        character: { icon:'üßë', name:'Cousin Wei', role:'Peer ¬∑ Same generation, close friend', context:'She just got back from traveling Southeast Asia. You haven\'t seen her in a year.' },
        correctId: 'wanshi',
        why: '‰∏á‰∫ãÂ¶ÇÊÑè (W√†n sh√¨ r√∫ y√¨) ‚Äî "May all things go as you wish" ‚Äî is warm and universal, perfect for peers. It\'s heartfelt without being too formal, covering all bases for her adventures.',
        distractors: ['shenti','caiyuan','bubu','shengyi','shengguan'],
      },
      {
        character: { icon:'üßë‚Äçüíº', name:'Uncle Lin', role:'Professional ¬∑ Business owner', context:'He just opened a second restaurant location. He\'s excitedly showing everyone photos on his phone.' },
        correctId: 'shengyi',
        why: 'ÁîüÊÑèÂÖ¥ÈöÜ (Shƒìng y√¨ xƒ´ng l√≥ng) means "May your business prosper" ‚Äî tailor-made for an entrepreneur celebrating expansion. It shows you pay attention to what matters to him.',
        distractors: ['shenti','hejia','xueye','wanshi','longma'],
      },
      {
        character: { icon:'üë®‚Äçüë©‚Äçüëß', name:'Uncle & Auntie Zhao', role:'Elder ¬∑ Extended family couple', context:'They drove 3 hours with their kids to be here. Auntie is arranging dishes on the table.' },
        correctId: 'hejia',
        why: 'ÈòñÂÆ∂Ê¨¢‰πê (H√© jiƒÅ huƒÅn l√®) ‚Äî "Joy for the whole family." When greeting a couple with children, this phrase warmly embraces everyone under their roof.',
        distractors: ['bubu','caiyuan','madao','gongzuo','shiye'],
      },
      {
        character: { icon:'üì±', name:'WeChat Group', role:'Mixed ¬∑ Family & friends chat', context:'The group is blowing up with stickers. You need a greeting that works for absolutely everyone.' },
        correctId: 'longma',
        why: 'ÈæôÈ©¨Á≤æÁ•û (L√≥ng m«é jƒ´ng sh√©n) invokes the mythical dragon-horse spirit ‚Äî boundless energy. It\'s festive, zodiac-themed for the Horse year, and universally uplifting.',
        distractors: ['shenti','caiyuan','bubu','shengyi','xueye'],
      },
      {
        character: { icon:'üéì', name:'Nephew Hao', role:'Student ¬∑ Your sister\'s son', context:'He\'s 16 and stressed about upcoming exams. He barely looks up from his textbook between courses.' },
        correctId: 'xueye',
        why: 'Â≠¶‰∏öÊúâÊàê (Xu√©y√® y«íu ch√©ng) ‚Äî "Academic success." For students, this is THE greeting. It shows you understand their world and are rooting for them.',
        distractors: ['shenti','caiyuan','hejia','shengyi','shengguan'],
      },
      {
        character: { icon:'üíº', name:'Colleague Fang', role:'Professional ¬∑ Coworker & friend', context:'You ran into her on the way in. She just mentioned she\'s hoping for a promotion this year.' },
        correctId: 'bubu',
        why: 'Ê≠•Ê≠•È´òÂçá (B√π b√π gƒÅo shƒìng) ‚Äî "Rising higher with every step." It\'s specifically about career advancement, which is exactly what\'s on her mind.',
        distractors: ['shenti','hejia','niannian','xueye','longma'],
      },
      {
        character: { icon:'üë©‚Äçüç≥', name:'Auntie Mei', role:'Elder ¬∑ Family friend & neighbor', context:'She catered half the dishes tonight. Everyone\'s raving about her fish ‚Äî there\'s always two, one for tomorrow.' },
        correctId: 'niannian',
        why: 'Âπ¥Âπ¥Êúâ‰Ωô (Ni√°n ni√°n y«íu y√∫) ‚Äî "Surplus year after year." The word ‰Ωô (surplus) sounds like È±º (fish), connecting to the tradition of serving two fish at New Year\'s Eve dinner.',
        distractors: ['caiyuan','bubu','madao','shiye','shengguan'],
      },
      {
        character: { icon:'ü§ù', name:'Partner Zhang', role:'Professional ¬∑ Your business partner', context:'She flew in from Shenzhen. You two have a big product launch planned for Q1.' },
        correctId: 'caiyuan',
        why: 'Ë¥¢Ê∫êÂπøËøõ (C√°i yu√°n gu«éng j√¨n) ‚Äî "May wealth flow from all directions." For a business partner, this specifically wishes that your shared ventures attract prosperity from every angle.',
        distractors: ['shenti','hejia','xueye','longma','niannian'],
      },
      {
        character: { icon:'üèá', name:'Friend Jie', role:'Peer ¬∑ Your oldest friend', context:'He\'s the life of the party. He just challenged your uncle to a baijiu drinking contest. It\'s the Year of his zodiac!' },
        correctId: 'yima',
        why: '‰∏ÄÈ©¨ÂΩìÂÖà (Yƒ´ m«é dƒÅng xiƒÅn) ‚Äî "The lead horse charges ahead." In a Horse year, this is perfect for someone with a competitive, spirited personality.',
        distractors: ['shenti','caiyuan','shengyi','hejia','xueye'],
      },
      {
        character: { icon:'üë∂', name:'Little Mei-Mei', role:'Child ¬∑ Your toddler niece', context:'She just learned the most important phrase at the dinner: "Give me my red envelope!"' },
        correctId: 'hongbao',
        why: 'ÊÅ≠ÂñúÂèëË¥¢ÔºåÁ∫¢ÂåÖÊãøÊù• (G≈çng x«ê fƒÅ c√°i, h√≥ng bƒÅo n√° l√°i) ‚Äî The classic children\'s rhyme! Kids say "Wishing you prosperity" and immediately follow up with "Now hand over the red envelope!"',
        distractors: ['shenti','bubu','madao','shiye','caiyuan'],
      },
      {
        character: { icon:'üí∞', name:'Uncle Bao', role:'Elder ¬∑ Wealthy uncle', context:'He just parked his new car outside and is handing out thick red envelopes to all the kids.' },
        correctId: 'gongxi',
        why: 'ÊÅ≠ÂñúÂèëË¥¢ (G≈çng x«ê fƒÅ c√°i) ‚Äî "Wishing you prosperity & fortune." This is THE classic CNY greeting, and especially fitting for someone who clearly values and enjoys wealth.',
        distractors: ['shenti','hejia','xueye','longma','yifan'],
      },
      {
        character: { icon:'üéí', name:'Cousin Tao', role:'Peer ¬∑ Just graduated college', context:'He\'s about to start his first real job next month. He keeps nervously adjusting his new watch.' },
        correctId: 'gongzuo',
        why: 'Â∑•‰ΩúÈ°∫Âà© (G≈çng zu√≤ sh√πn l√¨) ‚Äî "May your work go smoothly." For someone about to enter the workforce, this is perfectly targeted encouragement.',
        distractors: ['shenti','hejia','niannian','shengyi','changming'],
      },
      {
        character: { icon:'‚úàÔ∏è', name:'Auntie Yun', role:'Elder ¬∑ World traveler aunt', context:'She\'s planning a solo trip to Patagonia next month. She says this might be her most adventurous year yet.' },
        correctId: 'yifan',
        why: '‰∏ÄÂ∏ÜÈ£éÈ°∫ (Yƒ´ fƒÅn fƒìng sh√πn) ‚Äî "Smooth sailing in all things." For a traveler embarking on adventure, this is both literal and figurative ‚Äî wishing safe, smooth journeys.',
        distractors: ['caiyuan','bubu','shengyi','shengguan','xueye'],
      },
      {
        character: { icon:'üìà', name:'Manager Li', role:'Professional ¬∑ Your former boss', context:'She just got promoted to VP and brought a vintage bottle of Maotai to celebrate with the table.' },
        correctId: 'shengguan',
        why: 'ÂçáÂÆòÂèëË¥¢ (Shƒìng guƒÅn fƒÅ c√°i) ‚Äî "Win promotions & get rich." She just climbed the ladder, so this acknowledges her achievement and wishes for even more success ahead.',
        distractors: ['shenti','hejia','xueye','longma','niannian'],
      },
      {
        character: { icon:'üçú', name:'Second Uncle', role:'Elder ¬∑ Family foodie', context:'He\'s already on his third plate, declaring this the best reunion dinner in ten years. He loves abundance.' },
        correctId: 'niannian',
        why: 'Âπ¥Âπ¥Êúâ‰Ωô (Ni√°n ni√°n y«íu y√∫) ‚Äî "Surplus year after year." For someone who revels in abundance and good food, this wish for perpetual plenty is spot-on.',
        distractors: ['bubu','madao','gongzuo','shiye','shengguan'],
      },
      {
        character: { icon:'üè†', name:'Newlyweds', role:'Peer ¬∑ Cousin\'s new spouse', context:'They just got married last autumn. Everyone keeps teasing them and asking when the baby is coming.' },
        correctId: 'hejiaxf',
        why: 'ÈòñÂÆ∂Âπ∏Á¶è (H√© jiƒÅ x√¨ng f√∫) ‚Äî "Happiness for the whole family." For newlyweds, this warmly blesses their new household and the family they\'re building together.',
        distractors: ['caiyuan','bubu','madao','shengyi','xueye'],
      },
      {
        character: { icon:'üéØ', name:'Friend Kai', role:'Peer ¬∑ Your ambitious friend', context:'He just quit his job to start a tech company. He\'s pitching his idea to anyone who\'ll listen between bites.' },
        correctId: 'daji',
        why: 'Â§ßÂêâÂ§ßÂà© (D√† j√≠ d√† l√¨) ‚Äî "Great luck & big profits." For a bold entrepreneur, this combines the good luck he\'ll need with the big payoff he\'s chasing.',
        distractors: ['shenti','hejia','xueye','longma','niannian'],
      },
      {
        character: { icon:'üßß', name:'The Whole Table', role:'Everyone ¬∑ Time for a group toast!', context:'Grandpa stands up, raises his glass, and everyone looks to you to kick off the toast. Keep it universal.' },
        correctId: 'xinxiang',
        why: 'ÂøÉÊÉ≥‰∫ãÊàê (Xƒ´n xi«éng sh√¨ ch√©ng) ‚Äî "May all your wishes come true." It\'s the perfect toast for a whole table ‚Äî universally warm, aspirational, and inclusive of every dream in the room.',
        distractors: ['caiyuan','bubu','shengyi','shengguan','xueye'],
      },
      {
        character: { icon:'üíπ', name:'Cousin Rui', role:'Peer ¬∑ Finance worker', context:'He\'s been glued to his phone checking markets. He says this year is going to be huge for his portfolio.' },
        correctId: 'caiyuangun',
        why: 'Ë¥¢Ê∫êÊªöÊªö (C√°i yu√°n g«în g«în) ‚Äî "May wealth roll in." The word ÊªöÊªö (rolling) implies an unstoppable torrent of money ‚Äî perfect for someone obsessed with financial gains.',
        distractors: ['shenti','hejia','xueye','longma','yifan'],
      },
      {
        character: { icon:'‚ú°Ô∏è', name:'David', role:'Friend ¬∑ Your Jewish friend from college', context:'He heard there\'d be incredible food and showed up with a bottle of Manischewitz "for cultural exchange." He\'s loving every minute of this.' },
        correctId: 'xinnian',
        why: 'Êñ∞Âπ¥Âø´‰πê (Xƒ´n ni√°n ku√†i l√®) ‚Äî "Happy New Year!" The simplest, most universal greeting. For a friend from another culture joining the celebration, this is warm, welcoming, and easy to teach him to say back.',
        distractors: ['changming','shengguan','caiyuangun','shiye','bubu'],
      },
      {
        character: { icon:'üá∫üá∏', name:'Jenny', role:'Peer ¬∑ Your ABC friend', context:'She grew up speaking mostly English but lately has been taking Mandarin classes and watching C-dramas. Tonight she asked Grandma to only speak Chinese to her.' },
        correctId: 'gongxi',
        why: 'ÊÅ≠ÂñúÂèëË¥¢ (G≈çng x«ê fƒÅ c√°i) ‚Äî "Wishing you prosperity!" This is THE phrase every ABC kid remembers. Saying it to Jenny isn\'t just a greeting ‚Äî it\'s a shared cultural touchstone that says "welcome home."',
        distractors: ['xueye','gongzuo','yima','changming','shiye'],
      },
      {
        character: { icon:'ü•¨', name:'Mrs. Lau', role:'Community ¬∑ Chinatown grocery auntie', context:'She\'s run the produce shop on Mott Street for 30 years. You bumped into her at the market this morning and she slipped extra scallions into your bag.' },
        correctId: 'shengyi',
        why: 'ÁîüÊÑèÂÖ¥ÈöÜ (Shƒìng y√¨ xƒ´ng l√≥ng) ‚Äî "May your business prosper." Mrs. Lau IS her shop. Wishing her business well is the most personal, respectful thing you can say ‚Äî it honors her life\'s work.',
        distractors: ['xueye','madao','hejiaxf','yima','caiyuangun'],
      },
      {
        character: { icon:'üò§', name:'Mr. Peterson', role:'Neighbor ¬∑ Lives directly below you', context:'He\'s standing in your doorway in a bathrobe and slippers at 9 PM. The fish smell is wafting. The karaoke machine just started. He is not having a great evening.' },
        correctId: 'xinnian',
        why: 'Êñ∞Âπ¥Âø´‰πê (Xƒ´n ni√°n ku√†i l√®) ‚Äî "Happy New Year!" When your neighbor shows up mid-celebration looking like he\'s about to file a noise complaint, you kill him with pure, radiant warmth. Hand him a dumpling, wish him a happy new year, and suddenly he\'s at the party.',
        distractors: ['shengguan','caiyuangun','xueye','shiye','changming'],
      },
    ];

    /* ============================================================
       HELPERS
       ============================================================ */
    function shuffle(arr) {
      const a = [...arr];
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function loadStats() {
      try {
        return JSON.parse(localStorage.getItem('cny2026_stats')) || { gamesPlayed: 0, totalCorrect: 0, bestStreak: 0 };
      } catch { return { gamesPlayed: 0, totalCorrect: 0, bestStreak: 0 }; }
    }

    function saveStats(s) {
      try { localStorage.setItem('cny2026_stats', JSON.stringify(s)); } catch {}
    }

    function buildRounds() {
      const picked = shuffle(ALL_SCENARIOS).slice(0, 6);
      return picked.map(scenario => {
        const correct = greetingMap[scenario.correctId];
        // Pick 3 distractors from the scenario's distractor list
        const distractorIds = shuffle(scenario.distractors).slice(0, 3);
        const distractors = distractorIds.map(id => greetingMap[id]);
        // Combine and shuffle options
        const options = shuffle([correct, ...distractors]);
        return {
          character: scenario.character,
          correctId: scenario.correctId,
          correctGreeting: correct,
          why: scenario.why,
          options,
        };
      });
    }

    /* ============================================================
       APP
       ============================================================ */
    return {
      showToast: false,
      toastMessage: '',
      stats: loadStats(),
      rounds: [],
      roundIndex: 0,
      roundResult: null,       // null | 'correct' | 'wrong'
      selectedAnswerId: null,
      hongbaoFilled: 0,
      currentStreak: 0,
      gameComplete: false,
      roundHistory: [],
      peekedIds: [],

      get currentRound() {
        return this.rounds[this.roundIndex] || null;
      },

      togglePeek(id) {
        const idx = this.peekedIds.indexOf(id);
        if (idx === -1) { this.peekedIds.push(id); }
        else { this.peekedIds.splice(idx, 1); }
      },

      submitAnswer(opt) {
        if (this.roundResult) return;
        this.selectedAnswerId = opt.id;
        const correct = opt.id === this.currentRound.correctId;

        if (correct) {
          this.roundResult = 'correct';
          this.hongbaoFilled++;
          this.currentStreak++;
          this.stats.totalCorrect++;
          if (this.currentStreak > this.stats.bestStreak) {
            this.stats.bestStreak = this.currentStreak;
          }
          this.spawnConfetti();
          this.toast('üßß ' + this.currentRound.character.name + ' is delighted!');
        } else {
          this.roundResult = 'wrong';
          this.currentStreak = 0;
          this.toast('Not quite ‚Äî here\'s why...');
        }

        this.roundHistory.push({
          icon: this.currentRound.character.icon,
          guestName: this.currentRound.character.name,
          wasCorrect: correct,
          correctHanzi: this.currentRound.correctGreeting.hanzi,
          correctPinyin: this.currentRound.correctGreeting.pinyin,
          correctMeaning: this.currentRound.correctGreeting.meaning,
        });
      },

      nextRound() {
        this.roundResult = null;
        this.selectedAnswerId = null;
        this.peekedIds = [];
        if (this.roundIndex < 5) {
          this.roundIndex++;
          window.scrollTo({ top: document.querySelector('.character-spotlight')?.offsetTop - 120 || 0, behavior: 'smooth' });
        } else {
          this.gameComplete = true;
          this.stats.gamesPlayed++;
          saveStats(this.stats);
          if (this.hongbaoFilled === 6) {
            setTimeout(() => this.spawnConfetti(30), 300);
          }
          window.scrollTo({ top: document.querySelector('[x-show="gameComplete"]')?.offsetTop - 60 || 0, behavior: 'smooth' });
        }
      },

      newGame() {
        this.rounds = buildRounds();
        this.roundIndex = 0;
        this.roundResult = null;
        this.selectedAnswerId = null;
        this.peekedIds = [];
        this.hongbaoFilled = 0;
        this.currentStreak = 0;
        this.gameComplete = false;
        this.roundHistory = [];
        this.stats = loadStats();
        window.scrollTo({ top: window.innerHeight, behavior: 'smooth' });
      },

      copySingle(r) {
        const text = r.correctHanzi + '\n' + r.correctPinyin + '\n' + r.correctMeaning + '\n\nüê¥ Happy Year of the Horse 2026!';
        navigator.clipboard.writeText(text).then(() => this.toast('Copied!')).catch(() => this.toast('Tap and hold to copy'));
      },

      copyAll() {
        const unique = [];
        const seen = new Set();
        this.roundHistory.forEach(r => {
          if (!seen.has(r.correctHanzi)) {
            seen.add(r.correctHanzi);
            unique.push(r.correctHanzi + '\n' + r.correctPinyin + '\n' + r.correctMeaning);
          }
        });
        const text = 'üê¥ Happy Year of the Horse 2026! üßß\n\n' + unique.join('\n\n') + '\n\nÈ©¨Âà∞ÊàêÂäü ‚Äî May success gallop to you!';
        navigator.clipboard.writeText(text).then(() => this.toast('All greetings copied!')).catch(() => this.toast('Tap and hold to copy'));
      },

      spawnConfetti(count = 12) {
        const colors = ['#BC002D','#FFD700','#FF6B6B','#FFE066','#FF8C00'];
        const shapes = ['‚óè','‚ñ†','‚óÜ','üßß'];
        for (let i = 0; i < count; i++) {
          const el = document.createElement('div');
          el.className = 'confetti';
          el.textContent = shapes[Math.floor(Math.random() * shapes.length)];
          el.style.left = (15 + Math.random() * 70) + 'vw';
          el.style.top = (30 + Math.random() * 40) + 'vh';
          el.style.color = colors[Math.floor(Math.random() * colors.length)];
          el.style.fontSize = (12 + Math.random() * 18) + 'px';
          el.style.animationDuration = (1.2 + Math.random() * 1) + 's';
          el.style.animationDelay = (Math.random() * 0.4) + 's';
          document.body.appendChild(el);
          setTimeout(() => el.remove(), 2500);
        }
      },

      toast(msg) {
        this.toastMessage = msg;
        this.showToast = true;
        setTimeout(() => { this.showToast = false; }, 2500);
      },

      init() {
        this.rounds = buildRounds();
      },
    };
  }
  </script>
</body>
</html>
